name: hello_$(Build.DefinitionName)_$(SourceBranchName)_$(Date:yyyyMMdd)$(Rev:.rrrr)_$(TeamProject)_hello
trigger:
- master

variables:

  # Agent VM image name
  vmImageName: 'ubuntu-latest'
  MAVEN_CACHE_FOLDER: $(HOME)/.m2/repository
  MAVEN_OPTS: '-Dmaven.repo.local=$(MAVEN_CACHE_FOLDER)'
  CACHE_RESTORED: 'false'

stages:
- stage: Build
  displayName: Build stage
  jobs:
  - job: MavenPackageAndPublishArtifacts
    displayName: Maven Package and Publish Artifacts
    pool:
      vmImage: $(vmImageName)

    
    steps:
    - task: Cache@2
      inputs:
        key: 'maven | "$(agent.OS)" | **/pom.xml'
        path: $(MAVEN_CACHE_FOLDER)
        cacheHitVar: 'CACHE_RESTORED'
      
    - script: |
       echo "$(Pipeline.Workspace)"
       echo "$(MAVEN_CACHE_FOLDER)"
       echo "$(MAVEN_OPTS)"
       echo "$(System.DefaultWorkingDirectory)"